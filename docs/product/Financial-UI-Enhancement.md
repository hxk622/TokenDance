# 金融场景 UI 增强建议

## 核心理念

> **差异化定位**: TokenDance 金融版 ≠ BettaFish（报告生成器）
> 
> 我们是 **Vibe 投研工作台** - 让用户"和 AI 一起研究"，而不是"等 AI 生成报告"

---

## 一、舆情分析 UI 增强

### 1.1 实时情绪仪表盘（Dashboard Card）

**目标**: 可视化舆情数据，避免纯文本输出

```
┌─────────────────────────────────────────┐
│  茅台 (600519) - 舆情分析               │
├─────────────────────────────────────────┤
│  整体情绪: 看多 ↑                       │
│  ━━━━━━━━━━━━━━━━━━━ 0.65              │
│  (-1 看空 ←→ +1 看多)                   │
│                                         │
│  情绪分布:                              │
│  🟢 看多 45条 ███████████               │
│  🔴 看空 18条 ████                      │
│  ⚪中性 12条 ███                        │
│                                         │
│  数据来源: 雪球(40) · 股吧(35)         │
│  更新时间: 2分钟前                      │
└─────────────────────────────────────────┘
```

**实现方式**:
- Agent 返回 `SentimentResult` 的 JSON
- 前端用 Chart.js / Recharts 渲染
- 组件: `SentimentDashboard.vue`

---

### 1.2 帖子流（Post Stream）

**目标**: 展示原始帖子，支持"随时接管"

```
┌─────────────────────────────────────────┐
│  【雪球】                               │
│  @投资大佬: 茅台Q4业绩超预期，看好后市 │
│  👍 128  💬 45  ⏰ 3小时前              │
│  情绪: 看多 (0.8) ━━━━━━━━━            │
├─────────────────────────────────────────┤
│  【股吧】                               │
│  @股神张三: 短期有回调压力，注意风险   │
│  👍 56   💬 23  ⏰ 1小时前              │
│  情绪: 看空 (-0.6) ━━━━━               │
├─────────────────────────────────────────┤
│  [加载更多...]  [筛选: 只看看多]       │
└─────────────────────────────────────────┘
```

**交互能力**:
- 点击帖子 → 打开原链接（新标签页）
- 筛选按钮 → 只看看多/看空/高赞
- "接管" → 用户可以手动调整某条帖子的情绪标签

---

### 1.3 观点提取（Key Points）

**目标**: AI 提炼的核心观点，支持点击展开

```
┌─────────────────────────────────────────┐
│  看多观点 (3)                           │
│  ✓ Q4业绩超预期，营收增长稳健          │
│    来源: 雪球 @投资大佬 等 12 人       │
│  ✓ 高端白酒需求复苏，行业景气度提升    │
│    来源: 股吧 等 8 人                  │
│  ✓ 估值处于历史低位，安全边际高        │
│    来源: 雪球 等 5 人                  │
│                                         │
│  看空观点 (2)                           │
│  ⚠ 短期技术面有回调压力                │
│    来源: 股吧 @熊市专家 等 6 人        │
│  ⚠ 消费疲软担忧未消除                  │
│    来源: 雪球 等 4 人                  │
└─────────────────────────────────────────┘
```

**实现方式**:
- 展示 `analysis.key_bullish_points` / `key_bearish_points`
- 点击观点 → 展开相关帖子列表
- 支持"标记无效" → 用户可以删除不准确的观点

---

## 二、结构化数据 UI 增强

### 2.1 K线图 + 舆情叠加

**目标**: 技术面 + 舆情面融合展示

```
┌─────────────────────────────────────────┐
│  茅台 (600519) - 30日走势               │
├─────────────────────────────────────────┤
│  价格 ↑                                 │
│  1800 ┤     ╭─╮                         │
│  1750 ┤   ╭─╯ ╰╮                        │
│  1700 ┤ ╭─╯    ╰─╮                      │
│  1650 ┼─╯        ╰─                     │
│       └───────────────────→ 时间        │
│                                         │
│  情绪 📊                                │
│  +1.0 ┤     ●                           │
│   0.5 ┤ ●     ●                         │
│   0.0 ┼───●─────●──                     │
│  -0.5 ┤                                 │
│  -1.0 ┤                                 │
│       └───────────────────→ 时间        │
└─────────────────────────────────────────┘
```

**实现方式**:
- 用 ECharts / TradingView 渲染 K 线
- 叠加舆情数据点（气泡大小 = 讨论热度）
- 点击数据点 → 显示当日舆情摘要

---

### 2.2 多维对比卡片

**目标**: 一屏展示基本面 + 舆情

```
┌──────────────────┬──────────────────┐
│  技术面           │  舆情面          │
├──────────────────┼──────────────────┤
│  当前价: 1755.20  │  情绪: 看多 ↑   │
│  涨跌幅: +2.34%   │  评分: +0.65    │
│  市值: 2.2万亿    │  讨论: 75条     │
│  换手率: 0.45%    │  热度: 🔥🔥🔥  │
└──────────────────┴──────────────────┘
```

---

## 三、Vibe Workflow 特色交互

### 3.1 "干预" 按钮

**场景**: 用户觉得 AI 分析有误

```
Agent: "整体情绪偏看空 (-0.3)"

用户: [点击"我不这么认为"]

弹窗:
┌─────────────────────────────────────────┐
│  你觉得情绪应该是?                      │
│  ○ 看多   ● 中性   ○ 看空             │
│                                         │
│  理由（可选）:                          │
│  ┌─────────────────────────────────┐   │
│  │ 我觉得看多观点更有说服力...     │   │
│  └─────────────────────────────────┘   │
│                                         │
│  [重新分析]  [忽略此次]                │
└─────────────────────────────────────────┘
```

**作用**: 
- 体现 "Human in the Loop"
- 用户反馈存入 Memory → 改进未来分析

---

### 3.2 "沉淀" 功能

**场景**: 用户觉得某次分析很有价值

```
[保存为投研报告]
- 自动生成 Markdown 报告
- 包含数据、图表、观点
- 支持导出 PDF

[添加到观察列表]
- 设置定时提醒（每日更新舆情）
- 情绪显著变化时推送通知
```

---

## 四、实施优先级

### P0（必须有 - MVP）
- ✅ 后端 API 完成（已完成）
- ⚠️ **前端只需做最简单的 JSON 渲染**
  - 对话框内显示结构化数据
  - 类似 ChatGPT 的代码块样式即可

### P1（体验增强 - Vibe 1.0）
- 情绪仪表盘（SentimentDashboard 组件）
- 帖子流（PostStream 组件）
- 观点提取卡片

### P2（差异化 - Vibe Pro）
- K线 + 舆情叠加图
- "干预"按钮 + 反馈循环
- 投研报告生成 + 沉淀

---

## 五、技术栈建议

### 前端新增依赖
```json
{
  "dependencies": {
    "echarts": "^5.4.0",           // K线图
    "vue-echarts": "^6.6.0",
    "recharts": "^2.10.0"          // 备选图表库
  }
}
```

### 新增组件
```
frontend/src/components/financial/
├── SentimentDashboard.vue      # 情绪仪表盘
├── PostStream.vue              # 帖子流
├── KeyPointsCard.vue           # 观点提取
├── CombinedChart.vue           # K线+舆情融合图
└── FinancialReport.vue         # 投研报告生成器
```

---

## 六、与 BettaFish 的差异对比

| 维度 | BettaFish | TokenDance 金融版 |
|------|-----------|-------------------|
| **交互方式** | 提问 → 等报告 | 实时协作 + 随时干预 |
| **输出形式** | 纯文本报告 | 可视化仪表盘 + 报告 |
| **数据来源** | 黑盒 | 透明（显示原始帖子） |
| **可控性** | 低（只能重新提问） | 高（可标记、筛选、反馈） |
| **沉淀能力** | 弱（临时对话） | 强（保存、复用、追踪） |

---

## 七、下一步行动

### 对于当前 MVP
**建议**: **先不大改前端**，在现有对话框内：
1. 显示情绪评分（文字 + emoji）
2. 列出前 5 条帖子摘要
3. 加个"查看详细报告"按钮（打开新页面）

### 对于 Vibe 1.0
**启动时机**: 用户反馈"纯文本不够直观"时
**工作量**: 约 2-3 天（3个核心组件）

### 对于 Vibe Pro
**启动时机**: 有金融用户愿意深度使用时
**工作量**: 约 1-2 周（图表 + 交互逻辑）

---

## 八、小结

**当前阶段**: 
- ✅ 工具已经可用，通过对话调用即可
- ⚠️ **不需要立即大改前端**

**建议路径**:
1. **先跑通业务流程** - 看用户是否真的需要金融分析
2. **再优化体验** - 根据用户反馈决定 UI 优先级
3. **最后做差异化** - 当有稳定用户群时，上 Vibe Workflow

**核心原则**: 
> "不要为了做 UI 而做 UI，要为了解决用户问题而做 UI"

---

**参考文档**:
- `WARP.md` - 金融投研场景定位
- `Three-Column-Layout.md` - 三栏布局规范
- `UI-UX-Pro-Max-Integration.md` - UI 设计规范
